Allows free monad to participate in foreach and guard in for-comprehension

